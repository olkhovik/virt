# Домашняя работа к занятию «6.1 Типы и структура СУБД»

## _Задача №1_

_Архитектор ПО решил проконсультироваться у вас, какой тип БД 
лучше выбрать для хранения определенных данных._

_Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД._
_Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор._

---

**1. Электронные чеки в json виде**
- Подойдёт **MongoDB**, потому что документы в ней хранятся в JSON или BSON.

**2. Склады и автомобильные дороги для логистической компании**

- Тут надо понимать логику связей, думаю имеется ввиду цель оптимизация пути, склады и участки дорог от точки А до точки Б. Тогда теоретически удобны графовые БД - оптимизация пути по суммам стоимости рёбер графа (участков дорог). СУБД, как самую популярную данного типа - **Neo4j**.

**3. Генеалогические деревья**

- Подойдут реляционные БД, обеспечивающие связанность данных

**4. Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации**

- Подойдет БД – Ключ-значение. При выборе между **Redis** и **Memcached** выбор в сторону **Memcached**. В обоих данные хранятся в ОЗУ (в **Memcached** по умолчанию, Redis как опция).
В **Memcached** есть настройка времени жизни TTL, всё что нужно по условию задачи и более простой и быстрый по сравнению с **Redis** (не нужен доп. функционал Redis).

**5. Отношения клиент-покупка для интернет-магазина**

- реляционная БД, СУБД в зависимости от требований в производительности и наличия компетенций сотрудников.от

## _Задача №2_

_Вы создали распределенное высоконагруженное приложение и хотите классифицировать его согласно 
CAP-теореме. Какой классификации по CAP-теореме соответствует ваша система, если 
(каждый пункт - это отдельная реализация вашей системы и для каждого пункта надо привести классификацию)._

_А согласно PACELC-теореме, как бы вы классифицировали данные реализации?_

---
**1. Данные записываются на все узлы с задержкой до часа (асинхронная запись)**

- **По теореме CAP:** AP. Система доступна и возможно устойчива к разделению, но большая задержка делает данные несогласованными.
- **По теореме PACELC:** PA/EL. В нормальном режиме - низкая задержка, но данные не согласованы. При разделении данные доступны, но также не согласованы.

**2. При сетевых сбоях, система может разделиться на 2 раздельных кластера**
- **По теореме CAP:** система устойчива к разделению. Предполагаем, что 2 раздельных кластера - это 2 доступных кластера. Значит, AP: система доступна, но данные между ними не согласованы.
- **По теореме PACELC:** либо PA/EC, либо PA/EL.

**3. Система может не прислать корректный ответ или сбросить соединение**

Здесь неоднозначное условие.
- **По теореме CAP:**
   - если система в условиях разделения дает некорректный ответ, значит она несогласована, но доступна: AP
   - если система в условиях разделения сбрасывает соединение - значит, она недоступна, но наверное, данные целостны: CP
- **По теореме PACELC:**
   - если система в условиях разделения дает некорректный ответ: PA/EL (считаем, что в обычном режиме она также нацелена на быстрый, но не всегда корректный ответ).
   - если система в условиях разделения сбрасывает соединение: PC/EC (считаем, что в обычном режиме она также ориентирована на целостность данных в ущерб доступности).



## _Задача №3_

_Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?_

---

- Можно, если сочетать в одном проекте две разные СУБД, одна из которых отвечает требованиям ACID, а другая - BASE.
- В рамках одной СУБД эти два принципа противоречат друг другу: атомарность в ACID допускает только полное применение транзакции, а Soft State в BASE - наоборот, допускает незавершенные запросы. Хотя, если СУБД позволяет выполнять одни транзакции как BASE, а другие - как ACID, то нет проблем.


## _Задача №4_

_Вам дали задачу написать системное решение, основой которого бы послужили:_

- фиксация некоторых значений с временем жизни
- реакция на истечение таймаута

_Вы слышали о key-value хранилище, которое имеет механизм [Pub/Sub](https://habr.com/ru/post/278237/)._ 
_Что это за система? Какие минусы выбора данной системы?_

---
Полагаю, что речь идёт про **Redis**.

Минусы **Redis**:
- размер БД ограничен доступной памятью ОЗУ
- нет сегментации на пользователей или группы пользователей, отсутствует контроль доступа, доступ по общему паролю
- не имеет механизма консенсуса, при отказе ведущей реплики необходимо вручную выбрать новую ведущую реплику
- отсутствие очередей сообщений
- из самого подхода pub/sub следует, что по-умолчанию издетель не контролирует получение сообщений подписчиками
